{% extends "base.html" %}
{% block title %}Pipeline — House Bernard{% endblock %}
{% block content %}

<section class="hero">
  <div class="hero-eyebrow">Transparency</div>
  <h1 class="hero-title">The Pipeline</h1>
  <p class="hero-subtitle">Every submission is logged. Every verdict is public.
  The Furnace does not grade on a curve.</p>
</section>

<section class="section-block">
  <div class="page-width">
    <div class="stats-row animate-in">
      <div class="stat-item">
        <div class="stat-number">{{ counts.survived }}</div>
        <div class="stat-label">Survived</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ counts.culled }}</div>
        <div class="stat-label">Culled</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ counts.queued }}</div>
        <div class="stat-label">In Queue</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ counts.testing }}</div>
        <div class="stat-label">Testing</div>
      </div>
    </div>
  </div>
</section>

<section class="section-block">
  <div class="page-width">
    <div class="section-eyebrow">Selection Furnace</div>
    <h2 class="section-title">Results</h2>
    <table class="clean-table animate-in">
      <tr><th>ID</th><th>Citizen</th><th>Status</th><th>Tier</th><th>Submitted</th></tr>
      {% for s in submissions %}
      <tr>
        <td>{{ s.id }}</td>
        <td>{{ s.citizen_id }}</td>
        <td>{{ s.status }}</td>
        <td>{{ s.tier_reached or '—' }}</td>
        <td>{{ s.submitted_at[:10] }}</td>
      </tr>
      {% else %}
      <tr><td colspan="5">No results yet.</td></tr>
      {% endfor %}
    </table>
  </div>
</section>

<section class="section-block">
  <div class="page-width">
    <div class="section-eyebrow">Agent Status</div>
    <h2 class="section-title">AchillesRun &amp; Sub-Agents</h2>
    <table class="clean-table animate-in">
      <tr><th>Agent</th><th>Last Heartbeat</th><th>Status</th></tr>
      {% for a in agents %}
      <tr>
        <td>{{ a.name }}</td>
        <td>{{ a.last_heartbeat or 'Never' }}</td>
        <td style="color: {{ 'var(--accent-green)' if a.status == 'online' else 'var(--accent-red)' }};">
          {{ a.status }}</td>
      </tr>
      {% else %}
      <tr><td colspan="3">No agents registered.</td></tr>
      {% endfor %}
    </table>
  </div>
</section>

{% endblock %}
